   1 0000               #
   2 0000               # @author Brendan Kapp (bek7883)
   3 0000               #
   4 0000               # All input is handled in this file
   5 0000               #
   6 0000               PRINT_STRING = 4
   7 0000               READ_INT = 5
   8 0000               PRINT_INT = 1
   9 0000               READ_CHAR = 12
  10 0000               READ_STRING = 8
  11 0000               
  12 0000               	.data
  13 0000               	.align	2
  14 0000               input_data:
  15 0000 00000000		.word	0, 0, 0				# size, generations, wind
     0004 00000000
     0008 00000000
  16 000c               input_grid_data:
  17 000c 00000000		.space	32
          00000000
          00000000
          00000000
          00000000
          00000000
  18 002c               input_direction:
  19 002c 00000000		.space	32
          00000000
          00000000
          00000000
          00000000
          00000000
  20 004c               
  21 0000               	.text
  22 0000               	.align	2
  23 0000               
  24 0000               	.globl	input
  25 0000               	.globl	main
  26 0000               	.globl	grid_set
  27 0000               #
  28 0000               # input
  29 0000               #	parameters: none	
  30 0000               #	returns: v0 (-1 for fail, address of data for success)
  31 0000               #
  32 0000               input:
  33 0000 23BDFFDC		addi	$sp, $sp, -36
  34 0004 AFBF0020		sw	$ra, 32($sp)
  35 0008 AFB7001C		sw	$s7, 28($sp)
  36 000c AFB60018		sw	$s6, 24($sp)
  37 0010 AFB50014		sw	$s5, 20($sp)
  38 0014 AFB40010		sw	$s4, 16($sp)
  39 0018 AFB3000C		sw	$s3, 12($sp)
  40 001c AFB20008		sw	$s2, 8($sp)
  41 0020 AFB10004		sw	$s1, 4($sp)
  42 0024 AFB00000		sw	$s0, 0($sp)
  43 0028               
  44 0028 34080002		li	$t0, 2			
  45 002c 3C090000		la	$t1, input_data
     0030 35290000
  46 0034               						# empty input
  47 0034 240BFFFF		li	$t3, -1
  48 0038 AD2B0000		sw	$t3, 0($t1)
  49 003c AD2B0004		sw	$t3, 4($t1)
  50 0040 AD2B0008		sw	$t3, 8($t1)
  51 0044               
  52 0044               read_input_loop:
  53 0044 34020005		li	$v0, READ_INT			# read input
  54 0048 0000000C		syscall
  55 004c AD220000		sw	$v0, 0($t1)
  56 0050 21290004		addi	$t1, $t1, 4			# update pointer
  57 0054 2108FFFF		addi	$t0, $t0, -1
  58 0058 11000001		beq	$t0, $zero, read_input_text	# branch after 3
  59 005c 08000011		j	read_input_loop
  60 0060               read_input_text:
  61 0060 3C080000		la	$t0, input_direction
     0064 35080000
  62 0068 01002021		move	$a0, $t0
  63 006c 34050003		li	$a1, 3
  64 0070 34020008		li	$v0, READ_STRING
  65 0074 0000000C		syscall
  66 0078 810B0000		lb	$t3, 0($t0)
  67 007c AD2B0008		sw	$t3, 8($t1)	
  68 0080               read_input_done:
  69 0080               						# validate data
  70 0080 3C090000		la	$t1, input_data			# data address
     0084 35290000
  71 0088               						# check size (4 <= 30)
  72 0088 34030001		li	$v1, 1				# error code 1
  73 008c 340A0004		li	$t2, 4
  74 0090 340B001E		li	$t3, 30
  75 0094 8D2C0000		lw	$t4, 0($t1)
  76 0098 018A682A		slt	$t5, $t4, $t2
  77 009c 15A00018		bne	$t5, $zero, read_input_fail
  78 00a0 016C682A		slt	$t5, $t3, $t4
  79 00a4 15A00016		bne	$t5, $zero, read_input_fail
  80 00a8               						# check generations (0 <= 20)
  81 00a8 34030002		li	$v1, 2				# error code 2
  82 00ac 340A0000		li	$t2, 0
  83 00b0 340B0014		li	$t3, 20
  84 00b4 8D2C0004		lw	$t4, 4($t1)
  85 00b8 018A682A		slt	$t5, $t4, $t2
  86 00bc 15A00010		bne	$t5, $zero, read_input_fail
  87 00c0 016C682A		slt	$t5, $t3, $t4
  88 00c4 15A0000E		bne	$t5, $zero, read_input_fail	
  89 00c8               						# check wind (N, S, E, W)
  90 00c8               						# (78, 83, 69, 87)
  91 00c8 34030003		li	$v1, 3				# error code 3
  92 00cc 340A004E		li	$t2, 78
  93 00d0 8D2C0010		lw	$t4, 16($t1)
  94 00d4 AD2C0008		sw	$t4, 8($t1)			# reposition the wind
  95 00d8 01801821		move	$v1, $t4
  96 00dc 118A0007		beq	$t4, $t2, read_input_pass
  97 00e0 340A0053		li	$t2, 83
  98 00e4 118A0005		beq	$t4, $t2, read_input_pass
  99 00e8 340A0045		li	$t2, 69
 100 00ec 118A0003		beq	$t4, $t2, read_input_pass
 101 00f0 340A0057		li	$t2, 87
 102 00f4 118A0001		beq	$t4, $t2, read_input_pass
 103 00f8 08000040		j	read_input_fail
 104 00fc               read_input_pass:
 105 00fc               	#la	$v0, input_data			# return the data address
 106 00fc 08000042		j	read_grid_start
 107 0100               read_input_fail:
 108 0100 2402FFFF		la	$v0, -1				# return an error code
 109 0104 08000062		j	read_input_finish
 110 0108               read_grid_start:
 111 0108 3C090000		la	$t1, input_data			# data address
     010c 35290000
 112 0110 8D310000		lw	$s1, 0($t1)			# size of grid
 113 0114 34120000		li	$s2, 0				# counter
 114 0118               read_grid_loop:
 115 0118               	# read each line of input
 116 0118 3C040000		la	$a0, input_grid_data
     011c 34840000
 117 0120 34050020		li	$a1, 32	
 118 0124 34020008		li	$v0, READ_STRING
 119 0128 0000000C		syscall
 120 012c               	#la	$a0, input_grid_data
 121 012c               	#li	$v0, PRINT_STRING
 122 012c               	#syscall
 123 012c               	# verify each line (either continue or error)
 124 012c 3C140000		la	$s4, input_grid_data		# verify address
     0130 36940000
 125 0134 34130000		li	$s3, 0				# verify counter
 126 0138 2415FFFF		li	$s5, -1				# error code
 127 013c               verify_loop:
 128 013c 82840000		lb	$a0, 0($s4)
 129 0140 0C00006D		jal	grid_text_to_int
 130 0144 1055000B		beq	$v0, $s5, verify_fail
 131 0148               	# save each piece
 132 0148 02602021		move	$a0, $s3			# x location
 133 014c 02402821		move	$a1, $s2			# y location
 134 0150 00403021		move	$a2, $v0			# value
 135 0154 0C000000		jal	grid_set
 136 0158               
 137 0158 22730001		addi	$s3, $s3, 1
 138 015c 22940001		addi	$s4, $s4, 1
 139 0160 12710001		beq	$s3, $s1, verify_end
 140 0164 0800004F		j	verify_loop
 141 0168               verify_end:
 142 0168               	# go to next line		
 143 0168 22520001		addi	$s2, $s2, 1
 144 016c 12320004		beq	$s1, $s2, read_grid_finish
 145 0170 08000046		j	read_grid_loop
 146 0174               verify_fail:
 147 0174 2402FFFF		li	$v0, -1
 148 0178 34030004		li	$v1, 4
 149 017c 08000062		j	read_input_finish
 150 0180               read_grid_finish:
 151 0180 3C020000		la	$v0, input_data	
     0184 34420000
 152 0188               read_input_finish:
 153 0188 8FB00000		lw	$s0, 0($sp)
 154 018c 8FB10004		lw	$s1, 4($sp)
 155 0190 8FB20008		lw	$s2, 8($sp)
 156 0194 8FB3000C		lw	$s3, 12($sp)
 157 0198 8FB40010		lw	$s4, 16($sp)
 158 019c 8FB50014		lw	$s5, 20($sp)
 159 01a0 8FB60018		lw	$s6, 24($sp)
 160 01a4 8FB7001C		lw	$s7, 28($sp)
 161 01a8 8FBF0020		lw	$ra, 32($sp)
 162 01ac 23BD0024		addi	$sp, $sp, 36
 163 01b0 03E00008		jr	$ra
 164 01b4               
 165 01b4               #
 166 01b4               # takes in the grid input and returns the int to store
 167 01b4               # parameters: a0 (grid input)
 168 01b4               # returns: v0 (int to store, -1 for bad value)
 169 01b4               #
 170 01b4               grid_text_to_int:
 171 01b4 23BDFFFC		addi	$sp, $sp, -4
 172 01b8 AFBF0000		sw	$ra, 0($sp)
 173 01bc               						# ascii values to check for
 174 01bc               						# B (66), t (116), . (46)
 175 01bc 34080042		li	$t0, 66				# check for B
 176 01c0 34020003		li	$v0, 3				# set to burning
 177 01c4 10880007		beq	$a0, $t0, grid_text_end
 178 01c8 34080074		li	$t0, 116			# check for t
 179 01cc 34020002		li	$v0, 2				# set to tree
 180 01d0 10880004		beq	$a0, $t0, grid_text_end
 181 01d4 3408002E		li	$t0, 46				# check for .
 182 01d8 34020001		li	$v0, 1				# set to grass
 183 01dc 10880001		beq	$a0, $t0, grid_text_end
 184 01e0               	
 185 01e0 2402FFFF		li	$v0, -1				# error
 186 01e4               grid_text_end:
 187 01e4 8FBF0000		lw	$ra, 0($sp)
 188 01e8 23BD0004		addi	$sp, $sp, 4
 189 01ec 03E00008		jr	$ra


PRINT_INT          = 00000001   
PRINT_STRING       = 00000004   
READ_CHAR          = 0000000C   
READ_INT           = 00000005   
READ_STRING        = 00000008   
grid_set             ******** XG
grid_text_end        000001E4 R  text 
grid_text_to_int     000001B4 R  text 
input                00000000 RG text 
input_data           00000000 R  data 
input_direction      0000002C R  data 
input_grid_data      0000000C R  data 
main                 ******** XG
read_grid_finish     00000180 R  text 
read_grid_loop       00000118 R  text 
read_grid_start      00000108 R  text 
read_input_done      00000080 R  text 
read_input_fail      00000100 R  text 
read_input_finish    00000188 R  text 
read_input_loop      00000044 R  text 
read_input_pass      000000FC R  text 
read_input_text      00000060 R  text 
verify_end           00000168 R  text 
verify_fail          00000174 R  text 
verify_loop          0000013C R  text 
